import{_ as oe,j as se,u as ne,r as c,s as ie,o as ue,i as ce,a as v,b as _,c as g,d as l,f as o,g as i,q as T,P as de,e as m,t as d,F as re,l as pe,v as V,x as ve,m as N,y as O,p as me,h as he}from"./index-c7b8243f.js";const u=D=>(me("data-v-7bfa41e1"),D=D(),he(),D),_e={class:"grid"},ge={class:"col-12"},fe={class:"card"},be={class:"my-2"},ye={class:"flex flex-column md:flex-row md:justify-content-between md:align-items-center"},we={class:"m-0"},Ce={class:"text-primary"},xe={class:"block mt-2 md:mt-0 p-input-icon-left"},Se=u(()=>l("i",{class:"pi pi-search"},null,-1)),ke=u(()=>l("span",{class:"p-column-title"},"Name",-1)),Pe=u(()=>l("span",{class:"p-column-title"},"Category",-1)),Te=u(()=>l("span",{class:"p-column-title"},"Count",-1)),Ve=u(()=>l("span",{class:"p-column-title"},"Percent",-1)),De=u(()=>l("span",{class:"p-column-title"},"Price",-1)),Ie=u(()=>l("span",{class:"p-column-title"},"Message",-1)),Le=u(()=>l("span",{class:"p-column-title"},"Date",-1)),Ue={class:"field"},Me=u(()=>l("label",{for:"name"},"Name",-1)),Ne={class:"formgrid grid"},$e={class:"field col"},Be=u(()=>l("label",{for:"category1"},"Category",-1)),Fe={key:0},qe={key:1},ze={key:2},Ae={class:"field"},Oe=u(()=>l("label",{for:"quantity"},"Percent",-1)),je={class:""},Re={class:"p-inputgroup"},He=u(()=>l("span",{class:"p-inputgroup-addon"},"%",-1)),Ee={class:"field"},Ye=u(()=>l("label",{for:"count"},"Count",-1)),Qe={class:""},Ge={class:"p-inputgroup"},Je=u(()=>l("span",{class:"p-inputgroup-addon"},"сум",-1)),Ke={key:0,class:"all_price mt-4 mb-4"},We={class:"lg:font-bold"},Xe=["value"],Ze={class:"field"},et=u(()=>l("label",{for:"count"},"Message",-1)),tt={class:"p-float-label"},at={class:"flex align-items-center justify-content-center"},lt=u(()=>l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),ot={key:0},st={class:"flex align-items-center justify-content-center"},nt=u(()=>l("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1)),it={key:0},ut={__name:"Crud",setup(D){const C="http://127.0.0.1:8000",I=se();ne();const p=c(null),y=c(!1),x=c(!1),S=c(!1),e=c({}),b=c(null),$=c(null),L=c({}),w=c(!1);let B=c([]);const r=c(null),F=c(null),q=c(null),j=()=>{T.get(`${C}/get/product/`).then(s=>{B.value=s.data.reverse()})},R=new de;ie(()=>{ee(),j()}),ue(()=>{R.getTables().then(s=>{p.value=s.reverse(),F.value=s.length})});const H=()=>{e.value={},w.value=!1,y.value=!0},E=()=>{y.value=!1,w.value=!1},Y=async()=>{if(w.value=!0,e.value.name&&e.value.name.trim()&&e.value.count){if(e.value.id){p.value[K(e.value.id)]=e.value,r.value=e.value.category.price/100*e.value.percent+e.value.category.price,r.value=r.value*e.value.count,e.value.price=r.value;const s=new Date;e.value.date=s.toLocaleString(),e.value.price=r.value,e.value.price=e.value.price=r.value.toString();const a=e.value.category,n=e.value.price,k=Math.round(n);O.get("username")?q.value=O.get("username"):q.value="User";const P={name:e.value.name,price:k,message:e.value.message,date:e.value.date,count:e.value.count,percent:e.value.percent,category:a.id};await T({method:"PATCH",url:`${C}/edit/owner/${e.value.id}/`,data:P,headers:{"Content-Type":"multipart/form-data"}}).then(f=>{console.log(f),window.location.reload()}).catch(f=>{console.log(f)}),I.add({severity:"success",summary:"Successful",detail:"Product Updated",life:3e3})}else{e.value.id=z(),e.value.code=z(),e.value.image="product-placeholder.svg",p.value.unshift(e.value),r.value=e.value.category.price/100*e.value.percent+e.value.category.price,r.value=r.value*e.value.count,e.value.price=r.value.toString();const s=e.value.price,a=Math.round(s),n=new Date;e.value.date=n.toLocaleString(),e.value.price=r.value,e.value.price=e.value.price=r.value;const k=e.value.category,P={name:e.value.name,price:a,message:e.value.message,date:e.value.date,count:e.value.count,percent:e.value.percent,category:k.id};await T({method:"POST",url:`${C}/owner/`,data:P,headers:{"Content-Type":"multipart/form-data"}}).then(()=>{window.location.reload()}).catch(f=>console.log(f)),I.add({severity:"success",summary:"Successful",detail:"Product Created",life:3e3})}y.value=!1,e.value={}}},Q=s=>{e.value={...s},y.value=!0},G=s=>{e.value=s,x.value=!0},J=async s=>{p.value=p.value.filter(a=>a.id!==e.value.id),x.value=!1,await T({method:"POST",url:`${C}/delete/owner/${s}/`,headers:{"Content-Type":"multipart/form-data"}}).then(()=>{window.location.reload()}).catch(a=>console.log(a)),e.value={},I.add({severity:"success",summary:"Successful",detail:"Product Deleted",life:3e3})},K=s=>{let a=-1;for(let n=0;n<p.value.length;n++)if(p.value[n].id===s){a=n;break}return a},z=()=>{let s="";const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<5;n++)s+=a.charAt(Math.floor(Math.random()*a.length));return s},W=()=>{$.value.exportCSV()},X=s=>{S.value=!0},Z=()=>{p.value=p.value.filter(s=>!b.value.includes(s)),b.value.map(async s=>{console.log(s),await T({method:"POST",url:`${C}/delete/owner/${s.id}/`,headers:{"Content-Type":"multipart/form-data"}}).then(()=>{window.location.reload()}).catch(a=>console.log(a))}),S.value=!1,b.value=null,I.add({severity:"success",summary:"Successful",detail:"Products Deleted",life:3e3})},ee=()=>{L.value={global:{value:null,matchMode:ce.CONTAINS}}};return(s,a)=>{const n=v("Button"),k=v("FileUpload"),P=v("Toolbar"),f=v("InputText"),h=v("Column"),te=v("DataTable"),ae=v("Dropdown"),A=v("InputNumber"),le=v("Textarea"),M=v("Dialog");return _(),g("div",_e,[l("div",ge,[l("div",fe,[o(P,{class:"mb-4"},{start:i(()=>[l("div",be,[o(n,{label:"Sotish",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:H}),o(n,{label:"Ochirish",icon:"pi pi-trash",class:"p-button-danger",onClick:a[0]||(a[0]=t=>X(e.value.id)),disabled:!b.value||!b.value.length},null,8,["disabled"])])]),end:i(()=>[o(k,{mode:"basic",accept:"image/*",maxFileSize:1e6,label:"Import",chooseLabel:"Import",class:"mr-2 inline-block"}),o(n,{label:"Export",icon:"pi pi-upload",class:"p-button-help",onClick:a[1]||(a[1]=t=>W(t))})]),_:1}),o(te,{ref_key:"dt",ref:$,value:p.value,selection:b.value,"onUpdate:selection":a[3]||(a[3]=t=>b.value=t),paginator:!0,rows:5,rowsPerPageOptions:[5,10,25],paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} products",responsiveLayout:"scroll",filters:L.value},{header:i(()=>[l("div",ye,[l("h5",we,[m("Qarzdorlar: "),l("span",Ce,d(F.value),1)]),l("span",xe,[Se,o(f,{modelValue:L.value.global.value,"onUpdate:modelValue":a[2]||(a[2]=t=>L.value.global.value=t),placeholder:"Search users"},null,8,["modelValue"])])])]),default:i(()=>[o(h,{selectionMode:"multiple",headerStyle:"width: 3rem"}),o(h,{field:"name",header:"Name",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:i(t=>[ke,m(" "+d(t.data.name),1)]),_:1}),o(h,{field:"category",header:"Category",sortable:!0,headerStyle:"width:14%; min-width:8rem;"},{body:i(t=>[Pe,(_(!0),g(re,null,pe(t.data,U=>(_(),g("span",{key:U},d(U.label),1))),128))]),_:1}),o(h,{field:"count",header:"Count",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:i(t=>[Te,m(" "+d(t.data.count),1)]),_:1}),o(h,{field:"percent",header:"Percent",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:i(t=>[Ve,m(" "+d(t.data.percent+"%"),1)]),_:1}),o(h,{field:"price",header:"Balance",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:i(t=>[De,m(" "+d(t.data.price+"so'm"),1)]),_:1}),o(h,{field:"message",header:"Message",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:i(t=>[Ie,m(" "+d(t.data.message),1)]),_:1}),o(h,{field:"date",header:"Date",sortable:!0,headerStyle:"width:14%; min-width:10rem;"},{body:i(t=>[Le,m(" "+d(t.data.date),1)]),_:1}),o(h,{headerStyle:"min-width:10rem;"},{body:i(t=>[o(n,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success mr-2",onClick:U=>Q(t.data)},null,8,["onClick"]),o(n,{icon:"pi pi-trash",class:"p-button-rounded p-button-warning mt-2",onClick:U=>G(t.data)},null,8,["onClick"])]),_:1})]),_:1},8,["value","selection","filters"]),o(M,{visible:y.value,"onUpdate:visible":a[9]||(a[9]=t=>y.value=t),value:e.value,style:{width:"450px"},header:"Tovar Sotish",modal:!0,class:"p-fluid"},{footer:i(()=>[o(n,{label:"Bekor qilish",icon:"pi pi-times",class:"p-button-text",onClick:E}),o(n,{label:"Saqlash",icon:"pi pi-check",class:"p-button-text",onClick:Y})]),default:i(()=>[l("div",Ue,[Me,o(f,{placeholder:"Ism",id:"name",modelValue:e.value.name,"onUpdate:modelValue":a[4]||(a[4]=t=>e.value.name=t),autofocus:"",class:V({"p-invalid":w.value&&!e.value.name})},null,8,["modelValue","class"])]),l("div",Ne,[l("div",$e,[Be,o(ae,{id:"category1",modelValue:e.value.category,"onUpdate:modelValue":a[5]||(a[5]=t=>e.value.category=t),options:ve(B),optionLabel:"label",placeholder:"Tovarlar"},{value:i(t=>[t.value&&t.value.value?(_(),g("div",Fe,[l("span",{class:V("product-badge status-"+t.value.value)},d(t.value.label),3)])):t.value&&!t.value.value?(_(),g("div",qe,[l("span",{class:V("product-badge status-"+t.value.toLowerCase())},d(t.value),3)])):(_(),g("span",ze,d(t.placeholder),1))]),_:1},8,["modelValue","options"])])]),l("div",Ae,[Oe,l("div",je,[l("div",Re,[o(A,{class:V({"p-invalid":w.value&&!e.value.percent}),id:"quantity",modelValue:e.value.percent,"onUpdate:modelValue":a[6]||(a[6]=t=>e.value.percent=t),integeronly:"",placeholder:"Foiz"},null,8,["class","modelValue"]),He])])]),l("div",Ee,[Ye,l("div",Qe,[l("div",Ge,[o(A,{id:"count",modelValue:e.value.count,"onUpdate:modelValue":a[7]||(a[7]=t=>e.value.count=t),class:V({"p-invalid":w.value&&!e.value.count}),placeholder:"Soni"},null,8,["modelValue","class"]),Je])])]),e.value.name&&e.value.category&&e.value.percent&&e.value.count?(_(),g("div",Ke,[l("div",We,[m("All Price: "),l("span",{value:e.value,class:"text-primary lg:font-normal"},"2 "+d((e.value.category.price/100*e.value.percent+e.value.category.price)*e.value.count+"so'm"),9,Xe)])])):N("",!0),l("div",Ze,[et,l("span",tt,[o(le,{inputId:"textarea",rows:"3",cols:"30",modelValue:e.value.message,"onUpdate:modelValue":a[8]||(a[8]=t=>e.value.message=t),placeholder:"message..."},null,8,["modelValue"])])])]),_:1},8,["visible","value"]),o(M,{visible:x.value,"onUpdate:visible":a[12]||(a[12]=t=>x.value=t),style:{width:"450px"},header:"Tovar o'chirish",modal:!0},{footer:i(()=>[o(n,{label:"Yo'q",icon:"pi pi-times",class:"p-button-text",onClick:a[10]||(a[10]=t=>x.value=!1)}),o(n,{label:"Ha",icon:"pi pi-check",class:"p-button-text",onClick:a[11]||(a[11]=t=>J(e.value.id))})]),default:i(()=>[l("div",at,[lt,e.value?(_(),g("span",ot,[m("Are you sure you want to delete "),l("b",null,d(e.value.name),1),m("?")])):N("",!0)])]),_:1},8,["visible"]),o(M,{visible:S.value,"onUpdate:visible":a[14]||(a[14]=t=>S.value=t),style:{width:"450px"},header:"Tovarlarni o'chirish",modal:!0},{footer:i(()=>[o(n,{label:"Yo'q",icon:"pi pi-times",class:"p-button-text",onClick:a[13]||(a[13]=t=>S.value=!1)}),o(n,{label:"Ha",icon:"pi pi-check",class:"p-button-text",onClick:Z})]),default:i(()=>[l("div",st,[nt,e.value?(_(),g("span",it,"Are you sure you want to delete the selected products?")):N("",!0)])]),_:1},8,["visible"])])])])}}},dt=oe(ut,[["__scopeId","data-v-7bfa41e1"]]);export{dt as default};
